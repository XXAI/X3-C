<listar #ctrl URL="movimientos?tipo=5" titulo="Salida Receta"></listar>
<menu-farmacia [modulo]="'Salidas por recetas'" [icono]="'assets/icono-salidas.svg'" [url]="'/almacen/salidas-recetas'"></menu-farmacia>
<div style="height:50px;"></div>
<div class="contenedor columns " style="height:100%; ">
     <!-- <div class="column is-one-quarter is-hidden-mobile">
        <menu-lateral (onEnviarTipo)=enviarTipo($event);></menu-lateral>  -->
        <!-- <aside class="menu" style="padding: 1em;">
            <a routerLink="/almacen/salidas-recetas/nuevo" routerLinkActive="is-active" class="button is-primary is-inverted is-medium is-fullwidth"><span class="icon"  ><i class="fa fa-plus"></i></span> <span>Nueva Receta</span></a>
            <br>
            <ul class="menu-list">
                <li>
                    <a routerLink="/almacen/salidas-recetas" #receta routerLinkActive="is-active">
                        <span class="icon"><i class="fa fa-pencil-square-o"></i></span> Salida por receta
                        <span class="icon is-pulled-right" *ngIf="cargando"><i class="fa fa-circle-o-notch fa-spin"></i></span>
                        --><!-- <span class="tag is-pulled-right" [ngClass]="{ 'is-white': receta.className == 'is-active', 'is-primary': receta.className != 'is-active' }"></span> -->
                   <!--  </a>
                </li>
            </ul>

        </aside>
    </div>-->
    <div class="column" style="padding:2em;">
        <div style="background: #FFF; border-radius: 1em; overflow: hidden;">
            <section class="hero" [ngClass]=" {'is-dark': ctrl.busquedaActivada, 'is-primary': !ctrl.busquedaActivada } ">

                <div class="hero-body" style="position:relative;">
                    <a class="button  is-dark" *ngIf="ctrl.busquedaActivada" style="position:absolute; top:1em; right:1em;" (click)="ctrl.busquedaActivada=false;searchBox.value=''; ctrl.resultadosBusqueda=[]"><span class="icon "><i class="fa fa-close"></i></span></a>
                    <a class="button  is-dark" *ngIf="ctrl.busquedaActivada" style="position:absolute; top:1em; right:3.5em;" (click)="ctrl.listarBusqueda(searchBox.value,1)"><span class="icon "><i class="fa fa-refresh"></i></span></a>
                    <a class="button  is-primary" *ngIf="!ctrl.busquedaActivada" style="position:absolute; top:1em; right:1em;" (click)="ctrl.listar(1)"><span class="icon "><i class="fa fa-refresh"></i></span></a>
                    <div class="container is-fluid">

                        <div class="is-hidden-desktop">
                            <h1 class="title" *ngIf="!ctrl.busquedaActivada">
                                <span class="icon is-medium"><i class="fa fa-user"></i></span> Salidas por recetas
                            </h1>
                        </div>
                        <h1 class="title" *ngIf="ctrl.busquedaActivada">
                            <span class="icon is-medium"><i class="fa fa-search"></i></span> Búsqueda
                        </h1>
                        <div class="control is-grouped">
                            <p class="control is-expanded">
                                <input class="input is-medium" type="text" placeholder="Buscar" #searchBox id="search-box" (keyup)="ctrl.buscar(searchBox.value)">
                            </p>
                            <p class="control">
                                <a class="button is-medium is-primary is-inverted " routerLink="/almacen/salidas-recetas/nuevo">
                                    <span class="icon"><i class="fa fa-plus"></i></span><span>Nuevo</span>
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </section>
            <div class="is-fullwidth has-text-centered" *ngIf="ctrl.cargando">
                <br>
                <span class="tag is-primary is-large "><span class="icon"><i class="fa fa-refresh fa-spin"></i></span> &nbsp;<span>Cargando...</span></span>
                <br>
                <br>
            </div>

            <table class="table is-responsive" *ngIf="!ctrl.cargando">
                <thead>
                    <tr>
                        <th><abbr title="Folio de receta">Folio</abbr></th>
                        <th>Turno</th>
                        <th>Usuario</th>
                        <th>Estatus</th>
                        <th style=" text-align: center;">Creado</th>
                        <th style=" text-align: center;">Actualizado</th>
                    </tr>
                </thead>
                <tbody *ngIf="!ctrl.busquedaActivada">
                    <tr *ngFor="let item of ctrl.dato; let i=index">
                        <th style="vertical-align: middle;"><a routerLink="/almacen/salidas-recetas/editar/{{item.id}}">{{ item.id }}</a></th>
                        <td style="vertical-align: middle;"><a routerLink="/almacen/salidas-recetas/editar/{{item.id}}">{{ item.movimiento_metadato.turno.nombre }} </a></td>
                        <td style="vertical-align: middle;"><a routerLink="/almacen/salidas-estandar/editar/{{item.id}}">{{ item.movimiento_usuario.nombre }} {{ item.movimiento_usuario.apellidos }} </a></td>
                        <td style="vertical-align: middle;"><a routerLink="/almacen/salidas-recetas/editar/{{item.id}}">{{ item.status }} </a></td>
                        <td style="vertical-align: middle; text-align: center;"><a routerLink="/almacen/salidas-estandar/editar/{{item.id}}">{{ item.created_at | date:'medium'}} </a></td>
                        <td style="vertical-align: middle; text-align: center;"><a routerLink="/almacen/salidas-estandar/editar/{{item.id}}">{{ item.updated_at | date:'medium'}} </a></td>

                    </tr>
                    <tr *ngIf="ctrl.dato.length == 0">
                        <td colspan="5" style="vertical-align: middle; color:#888;">Esta lista está vacía.</td>
                    </tr>
                </tbody>
                <tbody *ngIf="ctrl.busquedaActivada">
                    <tr *ngFor="let item of ctrl.resultadosBusqueda; let i=index">
                        <th style="vertical-align: middle;"><a routerLink="/almacen/salidas-recetas/editar/{{item.id}}">{{ item.id }}</a></th>
                        <td style="vertical-align: middle;"><a routerLink="/almacen/salidas-recetas/editar/{{item.id}}">{{ item.movimiento_metadato.turno.nombre }} </a></td>
                        <td style="vertical-align: middle;"><a routerLink="/almacen/salidas-estandar/editar/{{item.id}}">{{ item.movimiento_usuario.nombre }} {{ item.movimiento_usuario.apellidos }} </a></td>
                        <td style="vertical-align: middle;"><a routerLink="/almacen/salidas-recetas/editar/{{item.id}}">{{ item.status }} </a></td>
                        <td style="vertical-align: middle; text-align: center;"><a routerLink="/almacen/salidas-estandar/editar/{{item.id}}">{{ item.created_at | date:'medium'}} </a></td>
                        <td style="vertical-align: middle; text-align: center;"><a routerLink="/almacen/salidas-estandar/editar/{{item.id}}">{{ item.updated_at | date:'medium'}} </a></td>

                    </tr>

                    <tr *ngIf="ctrl.resultadosBusqueda.length == 0 && ctrl.busquedaActivada">
                        <td colspan="5" style="vertical-align: middle; color:#888;">No se encontraron resultados.</td>
                    </tr>
                </tbody>
            </table>
            <!-- Paginación para la lista  -->
            <paginacion [total]="ctrl.total" [paginasTotales]="ctrl.paginasTotales" [resultadosPorPagina]="ctrl.resultadosPorPagina"
                [paginaActual]="ctrl.paginaActual" [indicePaginas]="ctrl.indicePaginas" (onSiguiente)="ctrl.paginaSiguiente()"
                (onAnterior)="ctrl.paginaAnterior()" (onListar)="ctrl.listar($event)" *ngIf="ctrl.total>0 && ctrl.total > ctrl.resultadosPorPagina && !ctrl.busquedaActivada"></paginacion>
            <!-- Paginación para la búsqueda  -->
            <paginacion [total]="ctrl.totalBusqueda" [paginasTotales]="ctrl.paginasTotalesBusqueda" [resultadosPorPagina]="ctrl.resultadosPorPaginaBusqueda"
                [paginaActual]="ctrl.paginaActualBusqueda" [indicePaginas]="ctrl.indicePaginasBusqueda" (onSiguiente)="ctrl.paginaSiguienteBusqueda(searchBox.value)"
                (onAnterior)="ctrl.paginaAnteriorBusqueda(searchBox.value)" (onListar)="ctrl.listarBusqueda(searchBox.value,$event)"
                *ngIf="ctrl.totalBusqueda > 0 && ctrl.totalBusqueda > ctrl.resultadosPorPaginaBusqueda && ctrl.busquedaActivada"></paginacion>



        </div>

    </div>
</div>